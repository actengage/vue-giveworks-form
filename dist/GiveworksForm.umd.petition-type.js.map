{"version":3,"sources":["webpack://GiveworksForm/./src/Components/Types/Petition.vue?86bb","webpack://GiveworksForm/src/Components/Types/Petition.vue","webpack://GiveworksForm/./src/Components/Types/Petition.vue?832d","webpack://GiveworksForm/./src/Components/Types/Petition.vue","webpack://GiveworksForm/./src/Mixins/FormEvents.js","webpack://GiveworksForm/./src/Mixins/PageType.js"],"names":["EVENTS","directives","bindEvents","bind","el","binding","vnode","context","subject","child","i","$on","args","method","camelCase","$emit","props","source","String","Number","trackingId","redirect","type","Boolean","default","undefined","httpOptions","Object","page","required","mixins","FormEvents","computed","buttonLabel","options","button","shouldShowEmployment","special","site","methods","submitButton","$refs","submit","$el","querySelector","hideSubmitButton","style","display","showSubmitButton","disableSubmitButton","disabled","enableSubmitButton","handleRedirect","url","sessionid","setTimeout","next_page","replace","form","window","location","match","success","failed","blur","Promise","resolve","reject","submitting","errors","model","save","assign","then","response","isFunction","data","Error","onSubmitSuccess","external_reply","get","onSubmitError","e","mounted","loaded","$nextTick","recurring","recurring_only","tracking_id","Page","id"],"mappings":"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","file":"GiveworksForm.umd.petition-type.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('contact-info-fieldset',{attrs:{\"legends\":false,\"form\":_vm.form,\"errors\":_vm.errors,\"page\":_vm.page}}),(_vm.page.options.add_comment)?_c('textarea-field',{directives:[{name:\"autogrow\",rawName:\"v-autogrow\"}],attrs:{\"id\":\"comment\",\"label\":_vm.commentMessage},model:{value:(_vm.form.comment),callback:function ($$v) {_vm.$set(_vm.form, \"comment\", $$v)},expression:\"form.comment\"}}):_vm._e(),_c('btn-activity',{attrs:{\"size\":\"lg\",\"type\":\"submit\",\"orientation\":\"right\",\"block\":true,\"activity\":_vm.submitting,\"label\":_vm.buttonLabel || _vm.page.site.config.giveworks.button.petition}}),(_vm.page.options.add_optin)?_c('checkbox-field',{attrs:{\"label\":_vm.optinMessage,\"value\":\"1\",\"custom\":\"\"}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <contact-info-fieldset :legends=\"false\" :form=\"form\" :errors=\"errors\" :page=\"page\" />\n\n        <textarea-field v-if=\"page.options.add_comment\" id=\"comment\" v-model=\"form.comment\" v-autogrow :label=\"commentMessage\" />\n\n        <btn-activity\n            size=\"lg\"\n            type=\"submit\"\n            orientation=\"right\"\n            :block=\"true\"\n            :activity=\"submitting\"\n            :label=\"buttonLabel || page.site.config.giveworks.button.petition\" />\n\n        <checkbox-field v-if=\"page.options.add_optin\" :label=\"optinMessage\" value=\"1\" custom />\n    </div>\n</template>\n\n<script>\nimport PageType from '../../Mixins/PageType';\n\nexport default {\n\n    name: 'PageTypePetition',\n\n    components: {\n        CheckboxField: () => import(/* webpackChunkName: \"vue-interface\" */'vue-interface/src/Components/CheckboxField'),\n        BtnActivity: () => import(/* webpackChunkName: \"vue-interface\" */'vue-interface/src/Components/BtnActivity'),\n        TextareaField: () => import(/* webpackChunkName: \"vue-interface\" */'vue-interface/src/Components/TextareaField'),\n        ContactInfoFieldset: () => import(/* webpackChunkName: \"contact-info-fieldset\" */'../Fieldsets/ContactInfoFieldset'),\n        EmploymentInfoFieldset: () => import(/* webpackChunkName: \"employment-info-fieldset\" */'../Fieldsets/EmploymentInfoFieldset')\n    },\n\n    extends: PageType\n\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Petition.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Petition.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Petition.vue?vue&type=template&id=e83df4ba&\"\nimport script from \"./Petition.vue?vue&type=script&lang=js&\"\nexport * from \"./Petition.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { camelCase } from 'vue-interface/src/Helpers/Functions';\n\nconst EVENTS = [\n    'submit',\n    'redirect',\n    'submit-enable',\n    'submit-disable',\n    'submit-show',\n    'submit-hide'\n];\n\nexport default {\n\n    directives: {\n        bindEvents: {\n            bind(el, binding, vnode) {\n                const context = vnode.context;\n                const subject = vnode.child || vnode.context;\n\n                for(const i in EVENTS) {\n                    subject.$on(EVENTS[i], (...args) => {\n                        const method = camelCase('on-' + EVENTS[i]);\n\n                        if(subject !== context) {\n                            context.$emit(EVENTS[i], ...args);\n                        }\n\n                        if(context[method]) {\n                            context[method](...args);\n                        }\n                    });\n                }\n            }\n        }\n    }\n\n};\n","import Page from '../Models/Page';\nimport FormEvents from './FormEvents';\nimport { isFunction } from 'vue-interface/src/Helpers/Functions';\n\nexport default {\n\n    props: {\n\n        source: [String, Number],\n\n        trackingId: [String, Number],\n\n        redirect: {\n            type: [Boolean, String],\n            default: undefined\n        },\n\n        httpOptions: Object,\n\n        page: {\n            type: Object,\n            required: true\n        }\n\n    },\n\n    mixins: [\n        FormEvents\n    ],\n\n    computed: {\n\n        buttonLabel() {\n            return this.page.options.button;\n        },\n\n        shouldShowEmployment() {\n            return this.page.page.special === 'donation' && (\n                this.page.site.type === 'PAC' || this.page.site.type === 'Campaign'\n            );\n        }\n\n    },\n\n    methods: {\n\n        submitButton() {\n            return this.$refs.submit ? this.$refs.submit.$el : this.$el.querySelector('[type=submit]');\n        },\n\n        hideSubmitButton() {\n            this.submitButton().style.display = 'none';\n        },\n\n        showSubmitButton() {\n            this.submitButton().style.display = 'block';\n        },\n\n        disableSubmitButton() {\n            this.submitButton().disabled = true;\n        },\n\n        enableSubmitButton() {\n            this.submitButton().disabled = false;\n        },\n\n        handleRedirect(url, sessionid) {\n            setTimeout(() => {\n                if(!url && this.page.next_page) {\n                    url = this.page.next_page.url.replace(/\\/$/, '') + (\n                        this.form.source ? '/' + this.form.source : ''\n                    );\n                }\n                \n                if(url) {\n                    window.location = url + (sessionid && (url.match(/\\?/) ? '&' : '?') + `sessionid=${sessionid}`);\n                }\n            });\n        },\n\n        submit(success, failed) {\n            if(this.$el.querySelector(':focus')) {\n                this.$el.querySelector(':focus').blur();\n            }\n\n            return new Promise((resolve, reject) => {\n                if(!this.submitting) {\n                    this.errors = {};\n                    this.submitting = true;\n                    this.$emit('submit');\n                    this.model.save(this.form, Object.assign({\n                        method: 'post'\n                    }, this.httpOptions))\n                        .then(response => {\n                            this.submitting = false;\n                            this.$emit('submit-complete', true, response);\n                            this.$emit('submit-success', response);\n\n                            if(isFunction(success)) {\n                                success(response);\n                            }\n\n                            resolve(response);\n                        }, response => {\n                            this.submitting = false;\n                            this.errors = response.data.errors;\n                            this.$emit('submit-complete', false, response);\n                            this.$emit('submit-failed', response);\n\n                            if(isFunction(failed)) {\n                                failed(response);\n                            }\n\n                            reject(response);\n                        });\n                }\n                else {\n                    reject(new Error('The form is already submitting'));\n                }\n            });\n        },\n\n        onSubmitSuccess(page) {\n            const redirect = this.redirect || this.page.external_reply || this.page.next_page && this.page.next_page.url;\n\n            if(this.redirect !== false && redirect) {\n                this.handleRedirect(redirect, page.get('sessionid'));\n            }\n        },\n\n        onSubmitError(e) {\n            throw e;\n        }\n\n    },\n\n    mounted() {\n        this.loaded = true;\n        this.$nextTick(() => this.$emit('init'));\n    },\n\n    data() {\n        const recurring = this.page.site.recurring ? (\n            this.page.options.recurring_only ? 1 : 0\n        ) : 0;\n        \n        return {\n            form: {\n                recurring,\n                source: this.source,\n                tracking_id: this.trackingId\n            },\n            errors: {},\n            loaded: false,\n            submitting: false,\n            model: new Page({\n                id: this.page.id\n            })\n        };\n    }\n\n};\n"],"sourceRoot":""}